from flask import Flask, request
from telegram import Bot, Update
from telegram.ext import Dispatcher, CommandHandler, MessageHandler, Filters
import logging
import random
import os

TOKEN = '7532659685:AAFJytrCeABPZGxYQ7Ahf5DRx4sD0Q3mUKU'  # ุชูฺฉู ุฑุจุงุช ุฎูุฏุชู
bot = Bot(token=TOKEN)
app = Flask(__name__)
dispatcher = Dispatcher(bot, None, workers=0)

logging.basicConfig(format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', level=logging.INFO)
logger = logging.getLogger(__name__)

# ุฏุณุชูุฑุงุช ุฑุจุงุช
def start(update, context):
    update.message.reply_text(
        "ุณูุงู ุนููุฌูู!\n\nููู ฺฉุงูู:\n- ุฎูุจ\n- ฺุฎุจุฑ\n- ุฏูุชูฺฏู\n- ุฏูุณุชุช ุฏุงุฑู\n- ุฎูุงุจู ูุงุฏ\n- ุนูู ุฌูู"
    )

def handle_message(update, context):
    text = update.message.text.strip().lower()

    if "ุณูุงู" in text:
        responses = [
            "ุณูุงู ุจู ุฑู ูุงูุช ุนููุฌูู",
            "ุณูุงู ุณูุทุงู!! ุฎูุด ุงููุฏ",
            "ุณูุงู ู ุตุฏุชุง ุณูุงู ุนูู๐น ุฌูู ๐",
            "ุนูฺฉ ุณูุงู ุนูู ุฌููุ ุจุงุฏ ุขูุฏ ู ุจู ุนูุจุฑ ุขูุฑุฏ๐๐"
        ]
        update.message.reply_text(random.choice(responses))

    elif any(word in text for word in ['ฺุฎุจุฑ', 'ฺู ุฎุจุฑ', 'ฺ ุฎุจุฑ']):
        update.message.reply_text("ุฎุจุฑุง ฺฉู ูพุด ุดูุงุณุช ุนููุฌูู!")

    elif "ฺฉุณ ุขููุงู ูุณุช" in text:
        update.message.reply_text("ูู ุขููุงูู ุนููุฌูู ๐ ฺฉุงุฑ ุฏุงุดุชุ")

    elif "ุนูู ุฌูู" in text:
        responses = [
            "ุฌุงู ุฏูู ุนููุ ุจฺฏู ุจุจูู ฺ ุดุฏู!",
            "ุฌุงูู ุนููุฌููุ ๐ ฺุฒ ูู ุฏุงุฑุ",
            "ุจูุฑูุงุฏ ุนููุฌููุ ู ูููู ฺฏุฑู ูุฎุตูุต ุดูุงโ๏ธ",
            "ุนููุฌูู ุจูุฑูุง ุจุดูุ ูููู ุชุงุฒู ู ุฏุงุบ ุจุง ฺฉฺฉ ุชุงุฒู ุจุฑุงุช ุจุงุฑู๐๐"
        ]
        update.message.reply_text(random.choice(responses))

    elif "ุงุตู" in text and "ุงุตูุงุญ" not in text:
        update.message.reply_text("ุดูุง ูุงููุฑ ุซุจุช ุงุญูุงูุ ๐๐")

    elif any(word in text for word in ['ุจุง ูพู', 'ุจุง ูพ ู']):
        update.message.reply_text("ูพู ุฎุทุฑูุงฺฉู ุญุณู๐๐ฟ")

    elif any(word in text for word in ['ุฎุฏุงุญุงูุธ', 'ุฎุฏุงูฺฏูุฏุงุฑ', 'ุจุง']):
        responses = [
            "ุฎุฏุงูฺฏูุฏุงุฑ ุณุชูู๐๐น",
            "ูุนูุง ููุงุธุจ ุฎูุฏุช ุจุงุด ุณูุทุงู โค"
        ]
        update.message.reply_text(random.choice(responses))

    elif any(word in text for word in ['ฺฏุดููู', 'ฺฏุฑุณููู']):
        update.message.reply_text("ฺ ูู ุฏุงุฑ ุนููุฌููุ ๐")

    elif 'ููู ฺฉุงูู' in text or 'ููู ฺฉุงูู' in text:
        keywords = [
            'ุณูุงู', 'ฺุฎุจุฑ', 'ฺฉุณ ุขููุงู ูุณุช', 'ุนูู ุฌูู', 'ุงุตู', 'ุจุง ูพู', 'ุจุง ูพ ู',
            'ุฎุฏุงุญุงูุธ', 'ุฎุฏุงูฺฏูุฏุงุฑ', 'ุจุง', 'ฺฏุดููู', 'ฺฏุฑุณููู', 'ฺฉุงูู ูุงุชู', 'ูููุชู ูุนูุง',
            'ฺฉุงูู ฺฏูุงุณู', 'ฺุง ูุงุชู', 'ูุงุช ฺุงฺฉูุช', 'ูููู ุงูุฑฺฉุงูู', 'ุขุณ ฺฉุงู', 'ุงุณููุช ุชูุชโูุฑูฺฏ',
            'ฺุง ูุงุณุงูุง', 'ููููุงุฏ', 'ูุฑูพฺูู', 'ููฺฉโุดฺฉ ุดฺฉูุงุช', 'ฺุง ุณุจุฒ ูุงุชู', 'ุขุณ ุช',
            'ุงุณููุช ููุฒ ู ุจุงุฏุงู', 'ูููู ุชุฑฺฉ', 'ฺุง ูุงุชู', 'ุดุฑุจุช ุฒุนูุฑุงู', 'ุขุจ ูพุฑุชูุงู ุชุงุฒู', 'ููฺฉโุดฺฉ ูุงูู'
        ]
        update.message.reply_text("ฺฉููุงุช ฺฉูุฏ ููู ฺฉุงูู:\n- " + '\n- '.join(keywords))
        return

    recipes = {
        'ฺฉุงูู ูุงุชู': 'ุงุณูพุฑุณู ุฑุง ุจุง ุดุฑ ฺฏุฑู ูุฎููุท ฺฉูุฏ ู ุฑู ุขู ููู ุดุฑ ุจุฑุฒุฏ.',
        'ูููุชู ูุนูุง': 'ูุนูุงุน ุชุงุฒูุ ูููุ ุดฺฉุฑ ู ุขุจ ฺฏุงุฒุฏุงุฑ ุฑุง ุชุฑฺฉุจ ฺฉูุฏ.',
        'ฺฉุงูู ฺฏูุงุณู': 'ูููู ุณุฑุฏุ ุจุณุชู ู ุดุฑ ุฑุง ูุฎููุท ฺฉูุฏ ู ุจุง ุณุณ ุดฺฉูุงุช ุชุฒุฆู ฺฉูุฏ.',
        'ฺุง ูุงุชู': 'ฺุง ุณุงู ุฑุง ุจุง ุดุฑ ฺฏุฑู ู ุฏุงุฑฺู ุชุฑฺฉุจ ฺฉูุฏ.',
        'ูุงุช ฺุงฺฉูุช': 'ุดุฑ ฺฏุฑู ุฑุง ุจุง ูพูุฏุฑ ฺฉุงฺฉุงุฆู ู ุดฺฉูุงุช ุชุฎุชูโุง ูุฎููุท ฺฉูุฏ.',
        'ูููู ุงูุฑฺฉุงูู': 'ุงุณูพุฑุณู ุฑุง ุจุง ุขุจ ุฏุงุบ ุฑูู ฺฉูุฏ.',
        'ุขุณ ฺฉุงู': 'ูููู ุณุฑุฏ ุฑุง ุจุง ุฎ ู ุดุฑ ูุฎููุท ฺฉูุฏ.',
        'ุงุณููุช ุชูุชโูุฑูฺฏ': 'ุชูุชโูุฑูฺฏุ ุดุฑ ู ุฎ ุฑุง ุฏุฑ ูุฎููุทโฺฉู ุชุฑฺฉุจ ฺฉูุฏ.',
        'ฺุง ูุงุณุงูุง': 'ฺุง ุณุงู ุฑุง ุจุง ุดุฑ ู ุงุฏููโูุง ูุงุณุงูุง ุฏู ฺฉูุฏ.',
        'ููููุงุฏ': 'ุขุจ ูููุ ุดฺฉุฑ ู ุขุจ ุณุฑุฏ ุฑุง ูุฎููุท ฺฉูุฏ.',
        'ูุฑูพฺูู': 'ูููู ุณุฑุฏุ ุดุฑุ ุฎ ู ุดฺฉุฑ ุฑุง ุฏุฑ ูุฎููุทโฺฉู ุชุฑฺฉุจ ฺฉูุฏ.',
        'ููฺฉโุดฺฉ ุดฺฉูุงุช': 'ุจุณุชู ุดฺฉูุงุชุ ุดุฑ ู ุดฺฉูุงุช ุชุฎุชูโุง ุฑุง ูุฎููุท ฺฉูุฏ.',
        'ฺุง ุณุจุฒ ูุงุชู': 'ฺุง ุณุจุฒ ุฑุง ุจุง ุดุฑ ฺฏุฑู ูุฎููุท ฺฉูุฏ.',
        'ุขุณ ุช': 'ฺุง ุณุฑุฏ ุฑุง ุจุง ุฎ ู ููู ุณุฑู ฺฉูุฏ.',
        'ุงุณููุช ููุฒ ู ุจุงุฏุงู': 'ููุฒุ ุดุฑ ุจุงุฏุงู ู ุฎ ุฑุง ุชุฑฺฉุจ ฺฉูุฏ.',
        'ูููู ุชุฑฺฉ': 'ูููู ุชุฑฺฉ ุฑุง ุจุง ุขุจ ู ุดฺฉุฑ ุฏู ฺฉูุฏ.',
        'ฺุง ูุงุชู': 'ฺุง ูุงุชู ุฑุง ุจุง ุขุจ ุฏุงุบ ุฏู ฺฉูุฏ ู ุจุง ู ุณุฑู ฺฉูุฏ.',
        'ุดุฑุจุช ุฒุนูุฑุงู': 'ุฒุนูุฑุงูุ ุดฺฉุฑ ู ุขุจ ุฑุง ูุฎููุท ฺฉูุฏ.',
        'ุขุจ ูพุฑุชูุงู ุชุงุฒู': 'ูพุฑุชูุงู ุฑุง ุขุจฺฏุฑ ฺฉูุฏ ู ุณุฑู ฺฉูุฏ.',
        'ููฺฉโุดฺฉ ูุงูู': 'ุจุณุชู ูุงูู ู ุดุฑ ุฑุง ูุฎููุท ฺฉูุฏ.'
    }

    for item in recipes:
        if item in text:
            update.message.reply_text(recipes[item])
            break

# ูุตู ฺฉุฑุฏู ูุฑูุงูโูุง
dispatcher.add_handler(CommandHandler("start", start))
dispatcher.add_handler(MessageHandler(Filters.text & ~Filters.command, handle_message))

# ุขุฏุฑุณ ูุฎุตูุต ุฏุฑุงูุช ูพุงูโูุง ุงุฒ ุชูฺฏุฑุงู
@app.route(f'/{TOKEN}', methods=['POST'])
def webhook():
    update = Update.de_json(request.get_json(force=True), bot)
    dispatcher.process_update(update)
    return 'ok'

# ุตูุญู ุงุตู
@app.route('/')
def index():
    return 'ุฑุจุงุช ุจุง ููููุช ุงุฌุฑุง ุดุฏ.'

# ุงุฌุฑุง
if __name__ == '__main__':
    app.run(host='0.0.0.0', port=int(os.environ.get('PORT', 5000)))
