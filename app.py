import re
from flask import Flask

# دیکشنری کلیدواژه‌ها و پاسخ‌ها
responses = {
    "صبح بخیر": [
        "صبحت بخیر رفیق کافه‌ای! وقتشه فنجان قهوه‌ت رو آماده کنم! ☀️☕",
        "صبح شد و کافه بازه! بیا یه فنجون آرامش بزنیم! 🌅🍯",
        "بیدار شدی؟ یعنی وقتشه برات قهوه بریزم و موزیک پخش کنم! 🎶☕",
        "صبحت خوش! بخوای یا نخوای امروز خیلی قشنگه عمو چون تو هستی! ✨🌞",
        "سلام به خورشیدِ خودم! قهوه داغ با یه لبخند آماده‌ست! ☕️😊"
    ],
    "ظهر بخیر": [
        "ظهر بخیر عزیزِ دلم! وقتشه یه قهوه سبک بزنیم وسط روز! 🌤️☕",
        "ناهارتو خوردی؟ اگه نه بیا اینجا باهم ناهار بزنیم! 🍝🍵",
        "ظهر شد و دل یه گپ کافه‌ای می‌خواد! پایه‌ای؟ 🗨️☕",
        "نیم‌روزت پر نور و قهوه‌ات همیشه گرم! 🔆☕",
        "ظهر اومد و تو هنوز اینجایی، این یعنی روزم قشنگه! ❤️🌞"
    ],
    "شب بخیر": [
        "شب بخیر رفیق! بخواب تا خواب‌هات هم بوی قهوه بده! 🌙☕",
        "کافه فعلا بسته س ولی دلم همیشه به روت بازه عمو! تا ابد ! 💤❤️",
        "ستاره‌ها دارن بهم چشمک می‌زنن که بگم: شبت قشنگ عمو! ✨🌌",
        "خوب و آروم بخواب، که فردا با یه اسپرسو داغ منتظرتم عمو! ☕🌛",
        "شب خوش عمو ! بخوابی ببینی من برات یه فنجون عشق دم کردم! 🥰☕️"
    ],
    "سلام": [
        "سلام سلطان! چطوری رفیق کافه‌ای من؟ ☕👋",
        "سلام 🫡به به! نور چشمای کافه اومد! 🌞",
        "درود بر بهترین مهمون عمو کافه‌چی! 🍰",
        "سلام عمو جون، آماده‌ای برای یه قهوه داغ؟ 🔥☕"
    ],
    "خوبی؟": [
        "تا تو رو دیدم کیفم کوک شد عمو! ☕💖",
        "من خوبم، قهوه‌سازم سالمه، تو خوبی عموجون؟ 🛠️😊",
        "یه کم خواب‌آلودم ولی پایه‌م واسه یه فنجون رفاقت! 😴❤️",
        "سلامتی تو عمو! قهوه تازه دم شده بیا قهوه بزنیم! ☕️✨"
    ],
    "دلم گرفته": [
        "یه فنجون چای زعفرونی بزن، دلت وا شه رفیق! 🍵💛",
        "بیا حرف بزنیم، اینجا واسه دل دلتنگت بازه عمو جون! ❤️🗣️",
        "بیا بغلت کنم از راه دور! قهوه مهمون عمو! 🤗☕",
        "دلت تنگه؟ منم دل تنگت بودم عمو، بشین کنارم. 🪑🌙"
    ],
    "بیکارم": [
        "بی‌حوصله‌ای؟ بزن بریم یه بازی مافیا راه بندازیم! 🎭🔥",
        "دوست داری برات لطیفه بگم یا یه فکت عجیب؟ 😏📚",
        "تو بگو: شعر؟ خاطره؟ داستان کافه‌ای؟ ✍️☕",
        "یه قهوه می‌زنیم و بی کاریو پرت می‌کنیم دور! ☕🌀"
    ],
    "گرسنگی": [
        "پنکیک موز یا کیک شکلاتی؟ انتخاب با توئه! 🍫🍌",
        "یه شیک وانیلی بزنیم یا قهوه ترک؟ 🍨☕",
        "بیا منوی کافه رو ببین، یه چیزی پیدا می‌شه حتماً! 📋🍴"
    ],
    "عمو": [
        "بله، جونم عمو؟ مشتری دائمی خودمی دیگه! ❤️",
        "جانِ دلم عمو؟ بگو چیکار کنم برات! ☎️☕",
        "عموت همیشه هست، پایه‌ی هرچی رفیق باعشقه! 💌",
        "صدات پیچید تو کافه، حال دلم قشنگ شد! 📢❤️"
    ],
    "خداحافظ": [
        "برو ولی برگردا! جات همیشه خالیه کنار پنجره! 🪟☕",
        "مواظب خودت باش، قهوه بعدیت پای منه! 💸❤️",
        "بای بای، تا دیدار بعدی توی کافه رفیق! 👋🌙",
        "فعلاً رفیق، تو قلبم یه میز برات کنار گذاشتم! ❤️🪑"
    ],
    "لطیفه": [
        "یه قهوه با شیر ازدواج کرد، بچه‌ش شد کاپوچینو! ☕👶",
        "یه اسپرسو رفت خواستگاری، گفتن خیلی تلخی! 🥲💔"
    ],
    "تنها": [
        "تو تنها نیستی، عمو همیشه هست! 🧔☕",
        "بشین کنارم، باهم یه چیزی بخوریم و گپ بزنیم! 🍩🗣️",
        "تنهایی؟ بیا پیش عمو تنهاییت رو با یک فنجان قهوه با عمو تقسیم کن! ☕🍬"
    ],
    "دوستت دارم": [
        "عشق اومد تو کافه؟😍 یه قهوه دو نفره آماده‌ست! ☕❤️☕",
        "دل که دادی، شیرینی‌ش با عمو! 🍰💝",
        "عشق تلخه مثل اسپرسو، ولی قشنگه! 🥲☕",
        "بیا برات یه قهوه مخصوص عشق دم کنم! 🫶🔥"
    ],
    "منو نوشیدنی": [
        "لیست نوشیدنی‌های کافه: \n1. اسپرسو \n2. کاپوچینو \n3. لاته \n4. شیک شکلاتی \n5. چای زعفرونی \n6. شیک وانیلی \n7. قهوه ترک \nبرای هر نوشیدنی طرز تهیه رو بخواهید!"
    ]
}

# دیکشنری طرز تهیه نوشیدنی‌ها
beverages = {
    "اسپرسو": "برای تهیه اسپرسو، به میزان ۲۳ گرم پودر قهوه تازه آسیاب‌شده نیاز دارید. پودر قهوه را داخل پورتا فیلتر دستگاه اسپرسو بریزید و به مدت ۲۵ تا ۳۰ ثانیه آب داغ را از آن عبور دهید.",
    "کاپوچینو": "برای تهیه کاپوچینو ابتدا اسپرسو رو تهیه کنید و سپس شیر را بخار دهید و با اسپرسو ترکیب کنید. کف شیر را روی قهوه بریزید.",
    "لاته": "تهیه لاته مشابه کاپوچینو است، اما شیر بیشتری نسبت به کف شیر استفاده می‌شود. شیر را با اسپرسو ترکیب کنید.",
    "شیک شکلاتی": "شکلات ذوب‌شده و شیر سرد را با هم مخلوط کنید. سپس روی آن کمی خامه زده‌شده و شکلات رنده‌شده بریزید.",
    "چای زعفرونی": "چای سیاه را به همراه زعفران دم کرده و با کمی شکر به دلخواه سرو کنید.",
    "شیک وانیلی": "شیر، شکر و پودر وانیل را با هم مخلوط کنید و سپس در مخلوط‌کن به خوبی بزنید.",
    "قهوه ترک": "پودر قهوه ترک را به میزان دلخواه در قهوه‌جوش ترکیب کنید و آن را روی حرارت ملایم بگذارید تا بجوشد."
}

# تابع برای حذف فاصله‌ها، نیم‌فاصله‌ها و علامت‌های سوال و تعجب
def preprocess_input(user_input):
    user_input = re.sub(r'\s+', ' ', user_input)  # حذف فاصله‌های اضافی
    user_input = user_input.replace('‌', ' ')  # تبدیل نیم‌فاصله به فاصله
    user_input = user_input.replace('؟', '').replace('!', '').replace('؟', '')  # حذف علامت‌های سوال و تعجب
    return user_input.strip().lower()

# تابع برای پاسخ دادن به کاربر
def get_response(user_input):
    processed_input = preprocess_input(user_input)

    if processed_input == "منو نوشیدنی":
        return responses["منو نوشیدنی"][0]

    for keyword in responses:
        if keyword in processed_input:
            return responses[keyword][0]

    if processed_input in beverages:
        return beverages[processed_input]  # طرز تهیه نوشیدنی

    return "متاسفانه من پاسخی برای این درخواست ندارم."

# اجرای اپلیکیشن Flask
app = Flask(__name__)

@app.route('/')
def home():
    return "کافه آنلاین آماده است!"

# پورت 5000 رو به اپلیکیشن Flask اضافه می‌کنیم
if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000)
